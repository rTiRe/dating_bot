---
description: Список и описание всех сервисов приложения
layout:
  title:
    visible: true
  description:
    visible: true
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# ✨ Сервисы

{% embed url="https://miro.com/app/live-embed/uXjVIGwkThs=/?embedId=721092437808&moveToViewport=1358,-322,1039,717" %}

При проектировании системы было принято решение считать критичными данными только оценки пользователей других анкет. Как следствие - запросы на создание, чтение, обновление и удаление анкет могут теряться. В этом нет ничего страшного, ведь пользователь может обновить анкету еще раз, а отправить лайк во второй раз - уже врят ли, если ему уже показали следующую анкету.

<details>

<summary><strong>Бот</strong></summary>

Интерфейс, при помощи которого пользователь взаимодействует со всей системой.

Взаимодействует с

* **Redis** - для хранения состояний FSM
* **Kafka** - передает в нее события от пользователей и получает из нее уведомления для пользователей (например, о взаимном лайке)
* **Сервис аккаунтов** - для сохранения основых данных о пользователе при старте бота
* **Сервис анкет** - для взаимодействия с анкетой пользователя: создание, просмотр, обновление, удаление
* **Сервис рейтингов** - для получения списка анкет для показа пользователю

</details>

<details>

<summary><strong>Аккаунты</strong></summary>

Реализует crud-операции для взаимодействия с аккаунтами.

Взаимодействует с

* **База данных аккаунтов** - для сохранения информации об аккаунтах пользователей

</details>

<details>

<summary><strong>Анкеты</strong></summary>

Реализует основные crud-операции с анкетами пользователей.

Взимодействует с

* **База данных анкет** - для сохранения информации об анкетах пользователей
* **MinIO** - для сохранения изображений анкет пользователей
* **Сервис аккаунтов** - для привязки анкет к конкретному аккаунту
* **Сервис рейтингов** - уведомляет его об изменениях в анкетах

</details>

<details>

<summary><strong>Рейтинги</strong></summary>

Реализует логику сортировки анкет под каждого пользователя.

Взаимодействует с

* **База данных анкет** - для получения актуальной информации об анкетах пользователей
* **ElasticSearch** - для поиска и сортировки анкет под каждого пользователя по удаленности, полу, возрасту, схожести описаний
* **Redis** - для сохранения в кэше популярных анкет и нескольких, рассчитаных наперед, анкет для пользователей
* **ClickHouse** - для получения статистики взаимодействия пользователей с другими анкетами. Из нее будет рассчитываться время активности пользователя, а так же список уже просмотренных им анкет&#x20;

</details>

<details>

<summary><strong>Взаимодействия</strong></summary>

Реализует логику обработки взаимодействия пользователя с анкетами: лайки, дизлайки, мэтчи, решает кому отправлять уведомления.

Взаимодействует с

* **Kafka** - получает из нее действия пользователей и шлет уведомления в бот в случае мэтча
* **ClickHouse** - для внесения данных о мэтчах
* **База данных анкет** - обновляет количество лайков и дизлайков у анкеты

</details>

<details>

<summary><strong>Kafka</strong></summary>

Брокер сообщений, отвечает за доставку критически важной информации.

Взаимодействует с

* **ClickHouse** - для автоматического внесения данных о лайках и дизлайках
* **Сервис бота** - см. раздел [Бот](./#bot)
* **Сервис взаимодействия** - см. раздел [Взаимодействия](./#vzaimodeistviya)

</details>
